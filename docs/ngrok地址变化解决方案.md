# ngrokåœ°å€å˜åŒ–è§£å†³æ–¹æ¡ˆ

## ğŸš¨ é—®é¢˜æè¿°

### æ ¸å¿ƒé—®é¢˜
- **ngrokå…è´¹ç‰ˆé™åˆ¶**ï¼šæ¯æ¬¡é‡å¯éƒ½ä¼šç”Ÿæˆæ–°çš„éšæœºåœ°å€
- **å®¢æˆ·ç«¯é…ç½®ç¡¬ç¼–ç **ï¼šæ‰“åŒ…æ—¶å°†æœåŠ¡å™¨åœ°å€å†™æ­»åœ¨é…ç½®æ–‡ä»¶ä¸­
- **åˆ†å‘å¤±æ•ˆ**ï¼šæœåŠ¡å™¨é‡å¯åï¼Œæ‰€æœ‰å·²åˆ†å‘çš„å®¢æˆ·ç«¯éƒ½æ— æ³•è¿æ¥

### é—®é¢˜åœºæ™¯
```
1. æ‰“åŒ…å®¢æˆ·ç«¯æ—¶ï¼šé…ç½®æ–‡ä»¶å†™å…¥ abc123.ngrok.io
2. åˆ†å‘ç»™ç”¨æˆ·ï¼šç”¨æˆ·å®‰è£…åå¯æ­£å¸¸è¿æ¥
3. æœåŠ¡å™¨é‡å¯ï¼šngrokç”Ÿæˆæ–°åœ°å€ xyz789.ngrok.io
4. ç”¨æˆ·æ–­è¿ï¼šæ‰€æœ‰å®¢æˆ·ç«¯æ— æ³•è¿æ¥æ–°åœ°å€
```

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šè‡ªåŠ¨é…ç½®æ›´æ–°ï¼ˆæ¨èï¼‰

#### å®ç°åŸç†
```
æœåŠ¡å™¨å¯åŠ¨ â†’ ç”Ÿæˆserver-info.json â†’ è„šæœ¬è¯»å– â†’ æ›´æ–°å®¢æˆ·ç«¯é…ç½® â†’ é‡æ–°æ‰“åŒ…
```

#### æ ¸å¿ƒæœºåˆ¶
1. **ä¿¡æ¯ä¼ é€’é“¾**ï¼š
   ```
   ngrokå¯åŠ¨ â†’ è·å–å…¬ç½‘åœ°å€ â†’ ä¿å­˜åˆ°server-info.json â†’ è„šæœ¬è¯»å– â†’ æ›´æ–°é…ç½®æ–‡ä»¶
   ```

2. **åŒé‡é…ç½®æ›´æ–°**ï¼š
   - **æ‰“åŒ…é…ç½®**ï¼š`modules/desktop-client/public/server-config.json`
   - **ç”¨æˆ·é…ç½®**ï¼š`~/.augment-device-manager/server-config.json`

3. **è‡ªåŠ¨åŒæ­¥**ï¼šè„šæœ¬ä»æœåŠ¡å™¨ä¿¡æ¯æ–‡ä»¶è¯»å–æœ€æ–°åœ°å€å¹¶æ›´æ–°æ‰€æœ‰é…ç½®

#### ä½¿ç”¨æ–¹æ³•
```bash
# 1. å¯åŠ¨æœåŠ¡å™¨ï¼ˆè·å¾—æ–°ngrokåœ°å€ï¼‰
npm run server:start

# 2. è‡ªåŠ¨æ›´æ–°é…ç½®ï¼ˆè¯»å–æ–°åœ°å€å¹¶æ›´æ–°é…ç½®æ–‡ä»¶ï¼‰
npm run config:update

# 3. é‡æ–°æ‰“åŒ…å®¢æˆ·ç«¯
npm run build:remote

# 4. åˆ†å‘æ–°çš„å®‰è£…åŒ…
# æ–°å®‰è£…åŒ…åŒ…å«æ­£ç¡®çš„æœåŠ¡å™¨åœ°å€
```

#### å®æ—¶ç›‘å¬æ¨¡å¼
```bash
# åå°è¿è¡Œï¼Œè‡ªåŠ¨æ£€æµ‹åœ°å€å˜åŒ–å¹¶æ›´æ–°é…ç½®
npm run config:watch
```

### æ–¹æ¡ˆäºŒï¼šå›ºå®šåœ°å€ï¼ˆé•¿æœŸæ–¹æ¡ˆï¼‰

#### é€‰é¡¹Aï¼šngrokä»˜è´¹ç‰ˆ
```bash
# å‡çº§åˆ°ä»˜è´¹ç‰ˆï¼ˆ$8/æœˆï¼‰
# è·å¾—å›ºå®šåŸŸåï¼šaugment-server.ngrok.io
ngrok http 3002 --domain=augment-server.ngrok.io
```
- âœ… åœ°å€æ°¸è¿œä¸å˜
- âœ… ä¸€æ¬¡æ‰“åŒ…ï¼Œæ°¸ä¹…æœ‰æ•ˆ
- âœ… æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½è¿æ¥

#### é€‰é¡¹Bï¼šäº‘æœåŠ¡å™¨
```bash
# è´­ä¹°äº‘æœåŠ¡å™¨ï¼Œè·å¾—å›ºå®šIP
# å¦‚ï¼š123.456.789.0 æˆ– augment.yourdomain.com
```
- âœ… å®Œå…¨æ§åˆ¶
- âœ… åœ°å€æ°¸è¿œä¸å˜
- âœ… æ›´ç¨³å®š

### æ–¹æ¡ˆä¸‰ï¼šç”¨æˆ·æ‰‹åŠ¨é…ç½®

#### å†…ç½®é…ç½®å·¥å…·
å®¢æˆ·ç«¯å†…ç½®é…ç½®æ›´æ–°é¡µé¢ï¼š`config-updater.html`
- ç”¨æˆ·å¯ä»¥è‡ªå·±æ›´æ–°æœåŠ¡å™¨åœ°å€
- æ— éœ€é‡æ–°å®‰è£…å®¢æˆ·ç«¯
- æ”¯æŒå®æ—¶é…ç½®éªŒè¯

## ğŸ“‹ è¯¦ç»†æ“ä½œæŒ‡å—

### è‡ªåŠ¨é…ç½®æ›´æ–°æµç¨‹

#### 1. æœåŠ¡å™¨ä¿¡æ¯æ–‡ä»¶
```json
// server-info.jsonï¼ˆæœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆï¼‰
{
  "ngrokUrl": "840b-2408-8207-60d0-5330-143a-21b5-9543-a7ec.ngrok-free.app",
  "managementUrl": "https://840b-2408-8207-60d0-5330-143a-21b5-9543-a7ec.ngrok-free.app",
  "startTime": "2025-06-28T10:34:32.923Z",
  "status": "running"
}
```

#### 2. é…ç½®æ›´æ–°è„šæœ¬
```javascript
// scripts/setup/update-client-config.js æ ¸å¿ƒé€»è¾‘
async function updateClientConfig() {
  // 1. è¯»å–å½“å‰æœåŠ¡å™¨ä¿¡æ¯
  const serverInfo = await fs.readJson('server-info.json');
  const ngrokUrl = serverInfo.ngrokUrl;
  
  // 2. ç”Ÿæˆæ–°é…ç½®
  const newConfig = {
    server: {
      host: ngrokUrl,
      port: 443,
      protocol: 'https'
    }
  };
  
  // 3. æ›´æ–°å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶
  await fs.writeJson('modules/desktop-client/public/server-config.json', newConfig);
  
  // 4. æ›´æ–°ç”¨æˆ·é…ç½®ç›®å½•
  await fs.writeJson('~/.augment-device-manager/server-config.json', newConfig);
}
```

#### 3. æ‰§è¡Œæ•ˆæœç¤ºä¾‹
```bash
$ npm run config:update

ğŸ”„ åŠ¨æ€æ›´æ–°å®¢æˆ·ç«¯é…ç½®
======================

ğŸ“¡ æ£€æµ‹åˆ°å½“å‰ngrokåœ°å€: 840b-2408-8207-60d0-5330-143a-21b5-9543-a7ec.ngrok-free.app
âœ… å®¢æˆ·ç«¯é…ç½®å·²æ›´æ–°
âœ… ç”¨æˆ·é…ç½®å·²æ›´æ–°

ğŸ¯ é…ç½®è¯¦æƒ…:
   æœåŠ¡å™¨åœ°å€: https://840b-2408-8207-60d0-5330-143a-21b5-9543-a7ec.ngrok-free.app
   WebSocket: wss://840b-2408-8207-60d0-5330-143a-21b5-9543-a7ec.ngrok-free.app/ws

ğŸ’¡ ä¸‹ä¸€æ­¥æ“ä½œ:
1. é‡æ–°æ‰“åŒ…å®¢æˆ·ç«¯: npm run build:remote
2. åˆ†å‘æ–°çš„å®‰è£…åŒ…ç»™ç”¨æˆ·
3. æˆ–è€…è®©ç”¨æˆ·é‡å¯ç°æœ‰å®¢æˆ·ç«¯ï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
```

### å®æ—¶ç›‘å¬é…ç½®

#### å¯åŠ¨ç›‘å¬
```bash
npm run config:watch
```

#### ç›‘å¬é€»è¾‘
```javascript
// æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡åœ°å€å˜åŒ–
setInterval(async () => {
  const currentNgrokUrl = serverInfo.ngrokUrl;
  if (currentNgrokUrl !== lastNgrokUrl) {
    console.log(`ğŸ”„ æ£€æµ‹åˆ°åœ°å€å˜åŒ–: ${currentNgrokUrl}`);
    await updateClientConfig();
  }
}, 5000);
```

## ğŸ¯ æœ€ä½³å®è·µ

### å¼€å‘ç¯å¢ƒ
```bash
# 1. å¯åŠ¨æœåŠ¡å™¨
npm run server:start

# 2. åå°ç›‘å¬åœ°å€å˜åŒ–
npm run config:watch

# 3. å¼€å‘è¿‡ç¨‹ä¸­æœåŠ¡å™¨é‡å¯æ—¶è‡ªåŠ¨æ›´æ–°é…ç½®
```

### ç”Ÿäº§åˆ†å‘
```bash
# 1. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm run server:start

# 2. æ›´æ–°é…ç½®
npm run config:update

# 3. æ‰“åŒ…åˆ†å‘
npm run build:remote

# 4. åˆ†å‘ dist/ ç›®å½•ä¸‹çš„å®‰è£…åŒ…
```

### ç´§æ€¥ä¿®å¤
```bash
# å¦‚æœç”¨æˆ·åé¦ˆæ— æ³•è¿æ¥ï¼š
# 1. æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
npm run server:status

# 2. æ›´æ–°é…ç½®
npm run config:update

# 3. é‡æ–°æ‰“åŒ…åˆ†å‘
npm run build:remote
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### é™åˆ¶è¯´æ˜
1. **ngrokå…è´¹ç‰ˆ**ï¼šåœ°å€ä»ä¼šå˜åŒ–ï¼Œéœ€è¦é‡æ–°æ‰“åŒ…åˆ†å‘
2. **ç½‘ç»œä¾èµ–**ï¼šé…ç½®æ›´æ–°éœ€è¦æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
3. **æ‰‹åŠ¨æ“ä½œ**ï¼šä»éœ€è¦æ‰‹åŠ¨æ‰§è¡Œé…ç½®æ›´æ–°å’Œé‡æ–°æ‰“åŒ…

### æ¨èå‡çº§
1. **ngrokä»˜è´¹ç‰ˆ**ï¼šè·å¾—å›ºå®šåŸŸåï¼Œä¸€åŠ³æ°¸é€¸
2. **äº‘æœåŠ¡å™¨**ï¼šå®Œå…¨æ§åˆ¶ï¼Œæœ€ç¨³å®šçš„è§£å†³æ–¹æ¡ˆ
3. **è‡ªåŠ¨åŒ–è„šæœ¬**ï¼šç»“åˆCI/CDå®ç°å®Œå…¨è‡ªåŠ¨åŒ–

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. é…ç½®æ›´æ–°å¤±è´¥
```bash
âŒ æœåŠ¡å™¨æœªå¯åŠ¨ï¼Œè¯·å…ˆè¿è¡Œ: npm run server:start
```
**è§£å†³**ï¼šç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ

#### 2. åœ°å€æ£€æµ‹å¤±è´¥
```bash
âŒ æ›´æ–°é…ç½®å¤±è´¥: server-info.json not found
```
**è§£å†³**ï¼šæ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸å¯åŠ¨å¹¶ç”Ÿæˆäº†ä¿¡æ¯æ–‡ä»¶

#### 3. å®¢æˆ·ç«¯ä»æ— æ³•è¿æ¥
**è§£å†³æ­¥éª¤**ï¼š
1. ç¡®è®¤é…ç½®å·²æ›´æ–°ï¼šæ£€æŸ¥é…ç½®æ–‡ä»¶å†…å®¹
2. é‡æ–°æ‰“åŒ…ï¼š`npm run build:remote`
3. é‡æ–°åˆ†å‘ï¼šç¡®ä¿ç”¨æˆ·ä½¿ç”¨æœ€æ–°å®‰è£…åŒ…

### éªŒè¯æ–¹æ³•
```bash
# 1. æ£€æŸ¥æœåŠ¡å™¨ä¿¡æ¯
cat server-info.json

# 2. æ£€æŸ¥å®¢æˆ·ç«¯é…ç½®
cat modules/desktop-client/public/server-config.json

# 3. æ£€æŸ¥ç”¨æˆ·é…ç½®
cat ~/.augment-device-manager/server-config.json

# 4. æµ‹è¯•è¿æ¥
curl -k https://your-ngrok-url/api/health
```
