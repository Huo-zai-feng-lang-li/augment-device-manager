# å®¢æˆ·ç«¯åˆ†å‘è§£å†³æ–¹æ¡ˆ

## ğŸš¨ é—®é¢˜æè¿°

å½“å‰ä½¿ç”¨ngrokå…è´¹ç‰ˆå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
- ngrokåœ°å€æ¯æ¬¡é‡å¯éƒ½ä¼šå˜åŒ–
- å®¢æˆ·ç«¯é…ç½®ç¡¬ç¼–ç æœåŠ¡å™¨åœ°å€
- åˆ†å‘çš„å®¢æˆ·ç«¯æ— æ³•é€‚åº”åœ°å€å˜åŒ–

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨å›ºå®šåŸŸåï¼ˆæ¨èï¼‰

#### 1. è´­ä¹°ngrokä»˜è´¹ç‰ˆ
```bash
# å‡çº§åˆ°ngrokä»˜è´¹ç‰ˆï¼Œè·å¾—å›ºå®šåŸŸå
# è®¿é—® https://ngrok.com/pricing
# é€‰æ‹© Personal ($8/æœˆ) æˆ– Pro ($20/æœˆ)
```

#### 2. é…ç½®å›ºå®šåŸŸå
```bash
# åœ¨ngrokæ§åˆ¶å°åˆ›å»ºå›ºå®šåŸŸåï¼Œå¦‚ï¼šaugment-server.ngrok.io
# å¯åŠ¨æ—¶ä½¿ç”¨å›ºå®šåŸŸå
ngrok http 3002 --domain=augment-server.ngrok.io
```

#### 3. æ›´æ–°å¯åŠ¨è„šæœ¬
```javascript
// ä¿®æ”¹ scripts/server/start-server.js
function startNgrok(ngrokPath) {
  const domain = process.env.NGROK_DOMAIN || null;
  const args = domain ? 
    ["http", "3002", `--domain=${domain}`] : 
    ["http", "3002"];
    
  const ngrok = spawn(ngrokPath, args, {
    shell: true,
    stdio: "pipe",
  });
  // ...
}
```

### æ–¹æ¡ˆäºŒï¼šäº‘æœåŠ¡å™¨éƒ¨ç½²

#### 1. è´­ä¹°äº‘æœåŠ¡å™¨
- é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€AWSç­‰
- æ¨èé…ç½®ï¼š1æ ¸2Gï¼Œ5Må¸¦å®½
- è·å¾—å›ºå®šIPåœ°å€

#### 2. éƒ¨ç½²åç«¯æœåŠ¡
```bash
# ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
scp -r modules/admin-backend/ user@your-server:/opt/augment/

# å®‰è£…ä¾èµ–å¹¶å¯åŠ¨
cd /opt/augment/admin-backend
npm install
npm install -g pm2
pm2 start src/server.js --name augment-backend
pm2 startup
pm2 save
```

#### 3. é…ç½®åŸŸåï¼ˆå¯é€‰ï¼‰
```bash
# è´­ä¹°åŸŸåå¹¶è§£æåˆ°æœåŠ¡å™¨IP
# å¦‚ï¼šaugment.yourdomain.com -> 123.456.789.0
```

### æ–¹æ¡ˆä¸‰ï¼šåŠ¨æ€é…ç½®æ›´æ–°ï¼ˆæŠ€æœ¯æ–¹æ¡ˆï¼‰

#### 1. å®ç°æœåŠ¡å™¨åœ°å€å¹¿æ’­
```javascript
// æ–°å¢ï¼šmodules/desktop-client/src/server-discovery.js
class ServerDiscovery {
  async discoverServer() {
    // å°è¯•å¤šä¸ªå¯èƒ½çš„åœ°å€
    const candidates = [
      'https://augment-server.ngrok.io',
      'https://backup-server.ngrok.io',
      'http://127.0.0.1:3002'
    ];
    
    for (const url of candidates) {
      if (await this.testConnection(url)) {
        return url;
      }
    }
    return null;
  }
}
```

#### 2. å®ç°é…ç½®è‡ªåŠ¨æ›´æ–°
```javascript
// å®¢æˆ·ç«¯å¯åŠ¨æ—¶è‡ªåŠ¨å‘ç°æœåŠ¡å™¨
async function autoDiscoverServer() {
  const discovery = new ServerDiscovery();
  const serverUrl = await discovery.discoverServer();
  
  if (serverUrl) {
    await serverConfig.updateFromUrl(serverUrl);
  }
}
```

## ğŸ“‹ æ¨èå®æ–½æ­¥éª¤

### çŸ­æœŸè§£å†³ï¼ˆç«‹å³å¯ç”¨ï¼‰
1. **å‡çº§ngrokä»˜è´¹ç‰ˆ**ï¼ˆ$8/æœˆï¼‰
2. **é…ç½®å›ºå®šåŸŸå**
3. **æ›´æ–°å®¢æˆ·ç«¯é…ç½®**
4. **é‡æ–°æ‰“åŒ…åˆ†å‘**

### é•¿æœŸè§£å†³ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
1. **è´­ä¹°äº‘æœåŠ¡å™¨**ï¼ˆ$5-20/æœˆï¼‰
2. **éƒ¨ç½²åç«¯æœåŠ¡**
3. **é…ç½®è‡ªå®šä¹‰åŸŸå**
4. **å®ç°è‡ªåŠ¨æ›´æ–°æœºåˆ¶**

## ğŸ”§ å…·ä½“æ“ä½œå‘½ä»¤

### é…ç½®å›ºå®šngrokåŸŸå
```bash
# 1. å‡çº§ngrokè´¦æˆ·
# 2. åœ¨æ§åˆ¶å°åˆ›å»ºåŸŸåï¼šaugment-server.ngrok.io
# 3. å¯åŠ¨æœåŠ¡
npm run server:start -- --domain=augment-server.ngrok.io

# 4. é…ç½®å®¢æˆ·ç«¯
node scripts/setup/restore-server-config.js augment-server.ngrok.io 443 https

# 5. é‡æ–°æ‰“åŒ…
npm run build
```

### é…ç½®äº‘æœåŠ¡å™¨
```bash
# 1. éƒ¨ç½²åˆ°æœåŠ¡å™¨
scp -r . user@your-server:/opt/augment/

# 2. å¯åŠ¨æœåŠ¡
ssh user@your-server
cd /opt/augment
npm install
npm run server:start

# 3. é…ç½®å®¢æˆ·ç«¯
node scripts/setup/restore-server-config.js your-server.com 3002 http

# 4. é‡æ–°æ‰“åŒ…
npm run build
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ngrokå…è´¹ç‰ˆä¸é€‚åˆç”Ÿäº§åˆ†å‘**
2. **æ¯æ¬¡åœ°å€å˜åŒ–éƒ½éœ€è¦é‡æ–°æ‰“åŒ…**
3. **å»ºè®®ä½¿ç”¨å›ºå®šåœ°å€æ–¹æ¡ˆ**
4. **è€ƒè™‘å®ç°æœåŠ¡å™¨åœ°å€è‡ªåŠ¨å‘ç°æœºåˆ¶**
